syntax = "proto3";
package storage_interface;
option go_package = "Betterfly2/proto/storage";

import "storage/request.proto";
import "storage/response.proto";

enum StorageResult {
  OK = 0;
  SERVICE_ERROR = 255;

  RECORD_NOT_EXIST = 1;
}

message RequestMessage {
  string from_kafka_topic = 1;
  int64 target_user_id = 2;
  oneof payload {
    StoreNewMessage store_new_message = 3;
    QueryMessage query_message = 4;
    QuerySyncMessages query_sync_messages = 5;
    UpdateUserName update_user_name = 6;
    UpdateUserAvatar update_user_avatar = 7;
    QueryUser query_user = 8;
  }
}

message ResponseMessage {
  StorageResult result = 1;
  int64 target_user_id = 2;
  oneof payload {
    StoreMsgRsp store_msg_rsp = 3;
    MessageRsp msg_rsp = 4;
    SyncMessagesRsp sync_msgs_rsp = 5;
    UserInfoRsp user_info_rsp = 6;
  }
}